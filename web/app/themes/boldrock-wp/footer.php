<div class="orchard">
		<img src="http://brhs.flywheelsites.com/wp-content/themes/boldrock/images/dist/boldrock-prefooter-6.jpg"/>
		<div class="prefooter-content"><img src="http://brhs.flywheelsites.com/wp-content/themes/boldrock/images/dist/br_prefooter_text-01.svg"/></div>
	</div>
	<footer id="colophon" class="site-footer" role="contentinfo">
		<div class="prefooter-menu pfm-is-fixed">
			<ul id="menu-sticky-footer" class="footer-sticky"><li id="menu-item-429" class="ajax menu-item menu-item-type-post_type_archive menu-item-object-cider menu-item-429"><a href="http://brhs.flywheelsites.com/ciders/">Ciders</a></li>
<li id="menu-item-430" class="ajax menu-item menu-item-type-post_type_archive menu-item-object-locations menu-item-430"><a href="http://brhs.flywheelsites.com/visit/">Locations</a></li>
<li id="menu-item-428" class="ajax menu-item menu-item-type-post_type menu-item-object-page menu-item-428"><a href="http://brhs.flywheelsites.com/cider-finder/">Finder</a></li>
</ul>		</div>
		<div class="footer-top">
			<div class="footer-outer">
				<div class="footer-root">
					<div class="footerRoot_logo">
						<a class="ajax footer_logo_link" href="https://boldrock.com/">
							<svg id="br_logo" viewBox="0 0 520.8 583.59">
							    <path id="line" class="cls-1" d="M292.55,637.4c23.18.43,73.4,7.67,73.08,9.46-.31,1.77-50.16-2.89-73.08-2.89-87.08-.03-143.55,22.72-143.69,22.76l-34.26.07S176.19,635.235,292.55,637.4Z" transform="translate(-114.6 -83.205)"/>
							    <g id="hard_cider">
							      <polygon class="cls-1" points="431.42 526.1 458.39 526.1 458.39 519.79 431.42 519.79 431.42 510.91 460.24 510.91 460.24 504.61 417.85 504.61 417.85 542.55 461.2 542.55 461.2 536.24 431.42 536.24 431.42 526.1"/>
							      <path class="cls-1" d="M200.67,587.815l-22.86,37.94h12.96l4.74-8.05h25.04l4.55,8.05h13.67l-21.98-37.94Zm-1.66,23.59,9.28-16.18h.18l8.67,16.18Z" transform="translate(-114.6 -83.205)"/>
							      <path class="cls-1" d="M279.84,606.995v-.1c7.79-1.01,13.13-4.26,13.13-9.21,0-7.72-11.12-9.82-21.98-9.87H244.1v37.94h13.58v-15.3h14.36c4.47.11,5.35,3,5.69,5.11a70.868,70.868,0,0,0,2.37,10.19h14.98c-2.55-2.1-3.07-6.58-3.69-8.99C290.25,611.515,290.25,607.675,279.84,606.995Zm-10.78-2.84H257.68v-10.04h11.38c5.96.06,9.46,1.47,9.46,4.84S275.02,604.105,269.06,604.155Z" transform="translate(-114.6 -83.205)"/>
							      <path class="cls-1" d="M631.73,616.765c-1.14-5.25-1.14-9.09-11.57-9.77v-.1c7.8-1.01,13.14-4.26,13.14-9.21,0-7.72-11.12-9.82-21.98-9.87H584.43v37.94h13.58v-15.3h14.36c4.46.11,5.34,3,5.69,5.11a70.819,70.819,0,0,0,2.36,10.19H635.4C632.86,623.655,632.34,619.175,631.73,616.765Zm-22.34-12.61H598.01v-10.04h11.38c5.96.06,9.46,1.47,9.46,4.84S615.35,604.105,609.39,604.155Z" transform="translate(-114.6 -83.205)"/>
							      <polygon class="cls-1" points="43.86 519.58 19.95 519.58 19.95 504.61 6.38 504.61 6.38 542.55 19.95 542.55 19.95 525.89 44.04 525.89 44.04 542.55 57.61 542.55 57.61 504.61 43.86 504.61 43.86 519.58"/>
							      <path class="cls-1" d="M323.46,587.815H301.92v37.94h21.54c19.71.1,31.97-5.78,31.97-18.97S343.17,587.705,323.46,587.815Zm-.96,31.63h-7v-25.33h7c16.12-.1,18.48,6.62,18.48,12.67S338.62,619.555,322.5,619.445Z" transform="translate(-114.6 -83.205)"/>
							      <rect class="cls-1" x="332.58" y="504.61" width="13.57" height="37.94"/>
							      <path class="cls-1" d="M492.51,587.815H470.97v37.94h21.54c19.71.1,31.97-5.78,31.97-18.97S512.22,587.705,492.51,587.815Zm-.96,31.63h-7.01v-25.33h7.01c16.12-.1,18.48,6.62,18.48,12.67S507.67,619.555,491.55,619.445Z" transform="translate(-114.6 -83.205)"/>
							      <path class="cls-1" d="M413.31,592.905c8.15,0,12.18,3.21,12.09,7.2h14.46c-.62-9.51-12.01-13.08-26.55-13.08-18.3,0-26.53,8.67-26.53,19.76s8.23,19.76,26.53,19.76c14.54,0,25.93-3.58,26.55-13.09H425.4c.09,3.99-3.94,7.19-12.09,7.19-9.63,0-12.08-8.56-12.08-13.86S403.68,592.905,413.31,592.905Z" transform="translate(-114.6 -83.205)"/>
							    </g>
							    <g id="rock">
							      <path class="cls-1" d="M635.39,271.675s-16.24-17.09-19.18-17.97c-4.92-1.47-13.84-6.26-18.76-7.72-4.92-1.48-12.8-5.14-18.7-5.88s-43.83-3.54-43.83-3.54-16.73,7.33-25.59,11-18.7,6.61-24.61,9.54c-5.9,2.95-33.43,13.94-41.3,16.15s-21.65,7.35-25.6,8.07c-3.91.74-18.05,4.77-23.6,8.08-4.09,2.45-13.16.37-20.44,1.53-5.19.84-46.28,11.13-59.07,14.07s-49.97,18.52-57.84,19.98c-4.31.81-9.62,15.21-17.24,16.68-21.35,4.12-31.76,9.01-37.41,9.93-6.79,1.11-38.9,15.6-39.36,16.04-6.34,6.07-42.4,36.15-42.4,36.15v154.22H635.4Zm-418.3,236.04-30.62-44.67-.45,44.67H149.76V398.625s57.25-38.83,81.32-36.84c14.96,1.24,21.88,7.64,20.57,51.14-.26,8.23-1.8,13.5-3.9,16.48-6.16,8.74-24.56,19.03-24.56,19.03l35.03,59.28Zm145.19-75.08c0,16.44-.24,27.99-.73,34.73a52.275,52.275,0,0,1-3.66,16.89,34.43,34.43,0,0,1-16.96,18.2q-11.58,5.64-28.9,5.64t-28.9-5.64a35.488,35.488,0,0,1-17.21-18.2q-2.67-6.03-3.52-17.68-.855-11.67-.87-33.94v-30.65c0-16.41.25-19.2.74-25.92a52.558,52.558,0,0,1,3.65-16.9c3.74-8.21,10.51-12.92,16.84-17.55,8.26-6.06,36.69-26.64,58.41-19.54,7.96,2.6,12.98,9.3,16.72,17.68q2.67,6.3,3.53,17.94c.57,7.78.86,29.62.86,44.29Zm115.98-81.07-43.8,12.54v-16.07c0-6.16-.08-9.77-.24-10.8q-1.245-7.725-7.13-7.72c-5.6,0-8.37,4.42-8.37,13.27v119.4q0,16.35,8.13,16.35c3.43,0,5.56-1.74,6.38-5.24s1.23-10.6,1.23-21.28v-26.86h41.83v18.21q0,17.265-1.97,27.15-6.87,40.41-47.73,40.41-14.76,0-23.63-2.46-8.835-2.46-15.74-11.11a48.033,48.033,0,0,1-10.46-23.44q-2.07-13.275-2.08-39.5v-76.83q0-31.44,13.17-46.12c8.77-9.76,31.9-19.81,48.64-19.81q14.985,0,23.86,3.24a30.867,30.867,0,0,1,15.49,12.65C479.13,312.645,478.26,351.565,478.26,351.565Zm84.84,156.15-38.82-75.78-.34,75.78H486.01V283.395l37.94-3.46.09,64.73,36.04-69.51h44.89l-49.08,106.98,51.93,125.58Zm58.12,0a8.41,8.41,0,1,1,8.4-8.43A8.405,8.405,0,0,1,621.22,507.715Z" transform="translate(-114.6 -83.205)"/>
							      <path class="cls-1" d="M621.29,495.765h-1.85v2.54h1.64c1.44-.05,1.78-.66,1.78-1.42C622.86,496.155,622.52,495.765,621.29,495.765Z" transform="translate(-114.6 -83.205)"/>
							      <path class="cls-1" d="M621.22,492.365a6.94,6.94,0,1,0,4.41,12.29,6.945,6.945,0,0,0-4.41-12.29Zm1.83,11.75c-.1-.56-.26-1.18-.32-1.77a3.739,3.739,0,0,0-.56-2.1c-.39-.41-.9-.36-1.44-.41h-1.29v4.28h-1.55v-9.89h3.2c1.81,0,3.7.49,3.7,2.73a2.285,2.285,0,0,1-2.02,2.31v.04c1.37.26,1.53.87,1.68,1.95a14.642,14.642,0,0,0,.57,2.86Z" transform="translate(-114.6 -83.205)"/>
							      <path class="cls-1" d="M313.63,353.265c-5.25,0-9.48,3.11-9.48,6.96v115.32c0,3.85,4.23,6.97,9.48,6.97s9.47-3.12,9.47-6.97V360.225C323.1,356.375,318.87,353.265,313.63,353.265Z" transform="translate(-114.6 -83.205)"/>
							      <path class="cls-1" d="M207.37,393.165c-5.7-4.31-18.71,4.98-18.71,4.98v37.13q13.905,0,17.71-2.96,3.78-2.985,3.79-12.83S210.96,395.895,207.37,393.165Z" transform="translate(-114.6 -83.205)"/>
							    </g>
							    <g id="bold">
							      <path class="cls-2" d="M370.1,111.4c-3.93-10.37-9.7-17.67-17.4-21.88s-17.82-6.32-30.33-6.32-22.67,2.16-30.46,6.48-13.62,11.56-17.51,21.72q-3.06,8.445-3.81,20.92-.75,12.495-.75,42.97v37.93q0,27.57.89,42.01c.56,9.62,1.8,16.91,3.67,21.89,3.89,10.37,16.86,21.21,47.97,11.58a154.822,154.822,0,0,0,30.08-13.17Q364.48,268.56,370.1,253a76.15,76.15,0,0,0,3.78-20.92q.765-12.48.77-42.97V175.3q0-27.24-.9-41.67Q372.865,119.2,370.1,111.4Zm-36.82,137.24c0,4.63-4.95,8.4-11.03,8.4-6.11,0-11.03-3.77-11.03-8.4v-120.4c0-4.65,4.92-8.41,11.03-8.41,6.08,0,11.03,3.76,11.03,8.41Z" transform="translate(-114.6 -83.205)"/>
							      <path class="cls-2" d="M597.72,107.655q-2.265-7.785-10.28-12.92a42.1,42.1,0,0,0-19.9-6.94q-11.64-1.23-38.69-1.24H495.31v135.43s73.93-11.65,78.62-12.29c7.01-1,12.73-3.23,17.15-6.65s7.05-8.61,7.88-15.58c.17-1.51.26-6.78.26-15.77v-46.38C599.22,116.965,598.7,111.065,597.72,107.655Zm-40.12,68.4c0,6.47-.31,10.71-.98,12.74-1.3,3.92-9.43,5.89-19.71,5.89v-85.7c6.79,0,13.85.54,16.6,1.61q4.1,1.62,4.09,8.27Z" transform="translate(-114.6 -83.205)"/>
							      <path class="cls-2" d="M241.35,101.625c-4.89-7.16-22.82-15.64-39.18-15.64H149.35v263.97s42.19,3.04,90.25-38.95c19.26-16.82,21.46-119.95-12.64-116.36C261.18,191.045,258.86,127.305,241.35,101.625Zm-47.19,22.19q12.45,0,16.26,1.9c2.53,1.27,6.44,2.76,6.44,8.46,0,7.48.2,36.1,0,38.21-.28,3.19-2.19,11.75-16.47,16.13a19.81,19.81,0,0,1-6.23,1.04Zm22.95,163.11c0,8.91-14.43,17.7-22.95,17.7v-75.02c7.8-3.35,22.95-9.46,22.95,5.64Z" transform="translate(-114.6 -83.205)"/>
							      <polygon class="cls-2" points="320.74 2.78 275.92 2.78 275.92 170.46 365.94 142.68 365.94 109.26 320.74 122 320.74 2.78"/>
							    </g>
							</svg>
						</a>
					</div>
					<div class="footerRoot_newsletter">
						<div class="newsletter_text">
							<h4>Stay in the Know</h4>
							<p>Sign up to receive our newsletter and stay up to date on all the latest Bold Rock news.</p>
						</div>
						<div class="newsletter_form">
							<form>
								<input type="text" placeholder="Email Address"/>
								<div class="submit_button">
									<input type="submit">
								</div>
							</form>
						</div>
					</div>
					<div class="footerRoot_menu">
						<ul id="menu-footer" class="footer_links"><li id="menu-item-279" class="menu-item menu-item-type-post_type menu-item-object-page menu-item-279"><a href="http://brhs.flywheelsites.com/contact/">Contact</a></li>
<li id="menu-item-286" class="ajax menu-item menu-item-type-post_type_archive menu-item-object-faqs menu-item-286"><a href="http://brhs.flywheelsites.com/faqs/">FAQs</a></li>
<li id="menu-item-280" class="ajax menu-item menu-item-type-post_type menu-item-object-page menu-item-280"><a href="http://brhs.flywheelsites.com/careers/">Careers</a></li>
<li id="menu-item-269" class="ajax menu-item menu-item-type-taxonomy menu-item-object-category menu-item-269"><a href="http://brhs.flywheelsites.com/blog/category/recipes/">Recipes</a></li>
<li id="menu-item-287" class="ajax menu-item menu-item-type-post_type_archive menu-item-object-locations menu-item-287"><a href="http://brhs.flywheelsites.com/visit/">Locations</a></li>
</ul>					</div>
					<div class="footerRoot_primary">
						<div class="footer_social">
							<ul class="social"><li class="social_link"><a href="https://www.facebook.com/BoldRockHardCider/" target="_blank" class="facebook"><svg><use xlink:href="#facebook"></use></svg></a></li><li class="social_link"><a href="https://twitter.com/boldrock" target="_blank" class="twitter"><svg><use xlink:href="#twitter"></use></svg></a></li><li class="social_link"><a href="https://www.instagram.com/boldrockhardcider/" target="_blank" class="instagram"><svg><use xlink:href="#instagram"></use></svg></a></li><li class="social_link"><a href="https://www.youtube.com/channel/UCa8tZwt05kXjUIIHIsLQgNw" target="_blank" class="youtube"><svg><use xlink:href="#youtube"></use></svg></a></li></ul>						</div>
						<div class="footer_ciderFinder">
							<a class="cider_finder_button slideButton" href="https://boldrock.com/cider-finder" data-hover="Cider Finder"><span>Cider Finder</span></a>
						</div>
					</div>
				</div>
			</div>
		</div>
		<div class="footer-bottom">
			<div class="footer-outer">
				<p>&copy;2019 Bold Rock Hard Cider. All Rights Reserved. <a class="footer-link" href="https://boldrock.com/privacy-policy/">Privacy Policy</a> and <a class="footer-link" href="https://boldrock.com/terms-and-conditions/">Terms and Conditions</a></p>
			</div>
		</div>
	</footer><!-- #colophon -->
</div><!--#pageWrapper-->
<?php wp_footer(); ?>
<script>
  function mapRun() {
    const mapArea = document.querySelector('#map');
    const useLoc = document.querySelector('#useLocation');
		const useZip = document.querySelector('#useZip');
    const locationResults = document.querySelector('#locationResults');
    const findBtn = document.querySelector('#find');
    const nextBtn = document.querySelector('#next');
    const prevBtn = document.querySelector('#previous');
    const resultsWrap = document.querySelector('.search-col');
    let Gmap;
    let searchParamString = '';
    let page = 0;
    let lat;
    let lng;
    let latlng;
    let image = "https://s3-us-west-2.amazonaws.com/s.cdpn.io/674055/BR-Events.png";
    var geocoder = new google.maps.Geocoder;
    var infowindow = new google.maps.InfoWindow({});
    var styledMapType = new google.maps.StyledMapType(
			[
  {
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#f5f5f5"
      }
    ]
  },
  {
    "elementType": "labels.icon",
    "stylers": [
      {
        "visibility": "off"
      }
    ]
  },
  {
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#616161"
      }
    ]
  },
  {
    "elementType": "labels.text.stroke",
    "stylers": [
      {
        "color": "#f5f5f5"
      }
    ]
  },
  {
    "featureType": "administrative.land_parcel",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#bdbdbd"
      }
    ]
  },
  {
    "featureType": "poi",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#eeeeee"
      }
    ]
  },
  {
    "featureType": "poi",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#757575"
      }
    ]
  },
  {
    "featureType": "poi.park",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#e5e5e5"
      }
    ]
  },
  {
    "featureType": "poi.park",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#9e9e9e"
      }
    ]
  },
  {
    "featureType": "road",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#ffffff"
      }
    ]
  },
  {
    "featureType": "road.arterial",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#757575"
      }
    ]
  },
  {
    "featureType": "road.highway",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#dadada"
      }
    ]
  },
  {
    "featureType": "road.highway",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#616161"
      }
    ]
  },
  {
    "featureType": "road.local",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#9e9e9e"
      }
    ]
  },
  {
    "featureType": "transit.line",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#e5e5e5"
      }
    ]
  },
  {
    "featureType": "transit.station",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#eeeeee"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "geometry",
    "stylers": [
      {
        "color": "#c9c9c9"
      }
    ]
  },
  {
    "featureType": "water",
    "elementType": "labels.text.fill",
    "stylers": [
      {
        "color": "#9e9e9e"
      }
    ]
  }
], {
      name: 'Styled Map'
    });

    function initMap() {
      var cville = {lat: 38.0310524, lng: -78.474159};
      let mapOptions = {
        center: cville,
        zoom: 17
      };
      // The map, centered at Uluru
      Gmap = new google.maps.Map(mapArea, mapOptions);
      //Associate the styled map with the MapTypeId and set it to display.
      Gmap.mapTypes.set('styled_map', styledMapType);
      Gmap.setMapTypeId('styled_map');
    };
    initMap();
    getLocation = () => {

      if (navigator.geolocation) {
        navigator.geolocation.getCurrentPosition(displayLocation)
      } else {
        console.log('problem');
      }
    }
    // displayLocation
    displayLocation = (position) => {
      console.log(position);
      lat = position.coords.latitude;
      lng = position.coords.longitude;
      latlng = {
        lat,
        lng
      }

      fillZip(latlng);

    }

    fillZip = (ll) => {
      //using index won't work all the time because the
      //number of items is not consistent from location to locatiton
      //use nested type value instead OR last value
       geocoder.geocode({'location': ll}, function(results, status) {
         let addressArr = results[0];
         let address = addressArr.formatted_address;
         console.log(addressArr.address_components);
         let zipcode = addressArr.address_components[7].short_name;

         let zipTemp = document.querySelector('#zip');
         zipTemp.value = zipcode;
         console.log(zipTemp.value);
         useLoc.classList.remove('loading-active');
         useLoc.classList.add('location-complete');
       })
    }

    showMap = (latlng, lat, lng) => {
      //add some sort of scroll behavior
      //console.log('in showmap: ' + latlng);
      let mapOptions = {
        center: latlng,
        zoom: 13
      };
      Gmap = new google.maps.Map(mapArea, mapOptions);
      //Associate the styled map with the MapTypeId and set it to display.
    Gmap.mapTypes.set('styled_map', styledMapType);
    Gmap.setMapTypeId('styled_map');

    }

    // Creates marker on the screen
    createMarker = (latlng) => {
      let markerOptions = {
        position: latlng,
        map: Gmap,
        clickable: true
        // draggable: true
      };
      Gmarker = new google.maps.Marker(markerOptions);
    }


    toTitleCase = (str) => {
        return str.replace(/\w\S*/g, function(txt){
            return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase();
        });
    }
    callVals = () => {

      pageParamString = `&page=${page}`;
      params = searchParamString + pageParamString;

      var xhttp = new XMLHttpRequest();

      xhttp.onreadystatechange = function() {
        //add preloader start
          if (xhttp.readyState==4 && xhttp.status==200) {
              var response = JSON.parse(xhttp.responseText);

              var results = response.locations.location;

              handleResponses(results);

              //handle page limits
              (response.end == response.total) ? nextBtn.setAttribute('disabled', true) : nextBtn.removeAttribute('disabled');
              (response.start == 1) ? prevBtn.setAttribute('disabled', true) : prevBtn.removeAttribute('disabled');

          }
      };
      xhttp.open('get', 'https://marcomm.mcintire.virginia.edu/cider?' + params, true);

      xhttp.send();
    }
    getSelectedVals = () => {
      let zip, brand, distance, storeType;
      event.preventDefault();
      zip = document.querySelector('#zip');
      brand = document.querySelector('#brand');
      distance = document.querySelector('#distance');
      storeType = document.querySelector('#storeType');

      let selected = brand.options[brand.selectedIndex];
      let selected_d = selected.getAttribute('data-type');

      if(zip.value !== '') {
        searchParamString += `zip=${zip.value}&`;
      }

      if(lat !== undefined) {
        searchParamString += `lat=${lat}&lng=${lng}`;
      }

      if(brand.value !== undefined) {
        let brandType = (selected_d == 'brand') ? "brand" : "category2";
        searchParamString+= `&${brandType}=${brand.value}`;
      }

      if(distance.value !== '') {
        searchParamString += `&distance=${distance.value}`;
      }
      if(storeType.value !== '') {
        searchParamString += `&storeType=${storeType.value}`;
      }

      console.log(lat + ', ' + lng);
      console.log(searchParamString);
      ((lat == null) && (zip.value == '')) ? locationError() : callVals(searchParamString);

    }
    locationError = () => {
      let errorBox = document.querySelector('#error');
      errorBox.innerHTML = "<p>You must provide location input!</p>";
    }
    buildMap = (geoList) => {
      console.log(geoList);
      if (latlng == undefined) {
        let latlngs = geoList.features[0].geometry.coordinates;
        latlng = new google.maps.LatLng(latlngs[0], latlngs[1]);
        console.log('in buildmap: ' + latlng);
      }
      showMap(latlng, lat, lng);
      createMarker(latlng);

      for (var i = 0; i < geoList.features.length; i++) {
        var coords = geoList.features[i].geometry.coordinates;

        var latLng = new google.maps.LatLng(coords[0], coords[1]);
        var marker = new google.maps.Marker({
          position: latLng,
          map: Gmap,
          title: 'Hello World!'
        });
        google.maps.event.addListener(
        marker,
        'click',
        (function(marker, i) {
          return function() {
            infowindow.setContent(geoList.features[i].info)
            infowindow.open(map, marker)
          }
        })(marker, i)
      )
      }
    }


    handleResponses = (locations) => {
      let output = '';
      let returnedLocs = {
        "type": "FeatureCollection",
        "features" : []
      };

      locations.forEach(function(location) {
        let name = toTitleCase(location.dba);
        let phone = location.phoneFormatted;
        let street = toTitleCase(location.street);
        let distance = toTitleCase(location.distance);
        let city = toTitleCase(location.city);
        let state = toTitleCase(location.state);
        let zip = location.zip;
        let lat = location.lat;
        let long = location.long;
        let address = street + '<br>' + city + ', ' + state + ' ' + zip;
        let mapLink = 'https://www.google.com/maps/search/?api=1&query=' + encodeURI(street + ' ' + city + ' ' + state + ' ' + zip);

        //Set up geo object
        let info = "<strong>" + name + "</strong><br>" + address + "<br><a href='" + mapLink  + "' target='_blank'>Get Directions</a>";
        let feature = {
          "type": "Feature",
          "geometry" : {}
        };
        let geometry = {
          "type": "Point",
          "coordinates": []
        }
        let properties = {};
        geometry.coordinates.push(Number(lat));
        geometry.coordinates.push(Number(long));
        properties['name'] = name;
        feature['geometry'] = geometry;
        feature['info'] = info;
        feature['properties'] = properties;
        returnedLocs.features.push(feature);

        output += '<div class="location"><h5>' + name +  '<span> (' + distance + 'miles away)</span></h5><p>' + address + '</p><a class="loc-map-link" target="_blank" href="' + mapLink + '">Find on Map</a></div>';
        locationResults.innerHTML = output;
      });
      buildMap(returnedLocs);

    }

    useLoc.addEventListener('click', function() {
      event.preventDefault();
      useLoc.classList.add('loading-active');
      getLocation();
      console.log('clicked');
    });

    //Pagination
    findBtn.addEventListener('click', function(){
      event.preventDefault();
      searchParamString = '';
      resultsWrap.classList.add('results-revealed');
			animateCSS('.search-wrap', 'slideOutUp');

      getSelectedVals();

    });
    next.addEventListener('click', function() {
      page++;
      callVals()
    });
    previous.addEventListener('click', function() {
      page--;
      callVals()
    });

		function animateCSS(element, animationName, callback) {
    const node = document.querySelector(element)
    node.classList.add('animated', animationName)

    function handleAnimationEnd() {
        node.classList.remove('animated', animationName)
        node.removeEventListener('animationend', handleAnimationEnd)

        if (typeof callback === 'function') callback()
    }

    node.addEventListener('animationend', handleAnimationEnd)
}


    var x, i, j, selElmnt, a, b, c;
  /*look for any elements with the class "custom-select":*/
  x = document.getElementsByClassName("custom-select");
  for (i = 0; i < x.length; i++) {
  selElmnt = x[i].getElementsByTagName("select")[0];
  /*for each element, create a new DIV that will act as the selected item:*/
  a = document.createElement("DIV");
  a.setAttribute("class", "select-selected");
  a.innerHTML = selElmnt.options[selElmnt.selectedIndex].innerHTML;
  x[i].appendChild(a);
  /*for each element, create a new DIV that will contain the option list:*/
  b = document.createElement("DIV");
  b.setAttribute("class", "select-items select-hide");
  for (j = 1; j < selElmnt.length; j++) {
    /*for each option in the original select element,
    create a new DIV that will act as an option item:*/
    c = document.createElement("DIV");
    c.innerHTML = selElmnt.options[j].innerHTML;
    c.addEventListener("click", function(e) {
        /*when an item is clicked, update the original select box,
        and the selected item:*/
        var y, i, k, s, h;
        s = this.parentNode.parentNode.getElementsByTagName("select")[0];
        h = this.parentNode.previousSibling;
        for (i = 0; i < s.length; i++) {
          if (s.options[i].innerHTML == this.innerHTML) {
            s.selectedIndex = i;
            h.innerHTML = this.innerHTML;
            y = this.parentNode.getElementsByClassName("same-as-selected");
            for (k = 0; k < y.length; k++) {
              y[k].removeAttribute("class");
            }
            this.setAttribute("class", "same-as-selected");
            break;
          }
        }
        h.click();
    });
    b.appendChild(c);
  }
  x[i].appendChild(b);
  a.addEventListener("click", function(e) {
      /*when the select box is clicked, close any other select boxes,
      and open/close the current select box:*/
      e.stopPropagation();
      closeAllSelect(this);
      this.nextSibling.classList.toggle("select-hide");
      this.classList.toggle("select-arrow-active");
    });
  }
  function closeAllSelect(elmnt) {
  /*a function that will close all select boxes in the document,
  except the current select box:*/
  var x, y, i, arrNo = [];
  x = document.getElementsByClassName("select-items");
  y = document.getElementsByClassName("select-selected");
  for (i = 0; i < y.length; i++) {
    if (elmnt == y[i]) {
      arrNo.push(i)
    } else {
      y[i].classList.remove("select-arrow-active");
    }
  }
  for (i = 0; i < x.length; i++) {
    if (arrNo.indexOf(i)) {
      x[i].classList.add("select-hide");
    }
  }
  }
  /*if the user clicks anywhere outside the select box,
  then close all select boxes:*/
  document.addEventListener("click", closeAllSelect);

  useZip.addEventListener("click", function() {
    useLoc.classList.add('is-hidden');
    zipDiv.classList.add('is-shown');
  });

  }
</script>
   <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyDjp7gOCyWv6E-nrUV41E_xw_8Krp_Q_go&callback=mapRun" async defer></script>
</body>
</html>
